<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Kunash Enterprises Admin</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Custom Styles (same as index.html) -->
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-8px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out; }

        .profile-img { object-fit: cover; }
        input, textarea { outline: none !important; }
        input:focus { box-shadow: 0 0 0 2px rgba(251, 146, 60, 0.3); }

        /* Sidebar collapse */
        .sidebar-collapsed { width: 5rem !important; }
        .sidebar-collapsed .sidebar-logo { width: 3rem !important; height: 3rem !important; }
        .sidebar-collapsed .sidebar-text { display: none; }

        /* Main content margin */
        .main-content { transition: margin-left 0.3s ease; }
    </style>
</head>
<body class="bg-gray-50 font-sans">

<div class="flex h-screen">

      <!-- Sidebar (unchanged) -->
    <div id="sidebar" class="w-64 bg-gray-800 text-white transition-all duration-300 fixed inset-y-0 left-0 z-20 flex flex-col">
        <div class="p-4 flex items-center justify-between">
            <img src="../assets/images/logoo bg.png" alt="Kunash Logo"
                 class="w-[10rem] h-[4rem] object-contain transition-all duration-300 sidebar-logo">
            <button id="toggle-btn" class="text-white p-1 rounded hover:bg-gray-700">
                <span class="material-icons text-xl">chevron_left</span>
            </button>
        </div>
        <nav class="mt-4 space-y-1 flex-1 px-2">
            <a href="../index.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">dashboard</span><span class="sidebar-text">Dashboard</span></a>
            <a href="products.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">inventory_2</span><span class="sidebar-text">Products</span></a>
            <a href="inventory.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">warehouse</span><span class="sidebar-text">Inventory</span></a>
            <a href="orders.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">shopping_cart</span><span class="sidebar-text">Orders</span></a>
            <a href="customers.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">people</span><span class="sidebar-text">Customers</span></a>
            <a href="banners.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">image</span><span class="sidebar-text">Banners</span></a>
            <a href="messages.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">mail</span><span class="sidebar-text">Messages</span></a>
            <a href="discounts.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">local_offer</span><span class="sidebar-text">Discount Management</span></a>
            <a href="admins.html" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">admin_panel_settings</span><span class="sidebar-text">Admin Management</span></a>
            <!-- PROFILE LINK (active on this page) -->
            <a href="/pages/profile.html"
               class="flex items-center py-2 px-3 bg-orange-600 font-semibold hover:bg-orange-500 rounded-lg transition">
                <span class="material-icons mr-3">person</span>
                <span class="sidebar-text">My Profile</span>
            </a>
            <a href="../login.html" id="logout-btn" class="flex items-center py-2 px-3 hover:bg-orange-500 rounded-lg transition mt-4">
                <span class="material-icons mr-3">logout</span><span class="sidebar-text">Logout</span></a>
        </nav>
    </div>

    <!-- ==================== MAIN CONTENT ==================== -->
    <div class="flex-1 flex flex-col overflow-hidden main-content ml-64 transition-all duration-300">

        <!-- Header -->
        <header class="bg-white shadow-md sticky top-0 z-50">
            <div class="flex justify-between items-center p-4 container mx-auto">
                <div class="flex items-center space-x-4">
                    <button id="sidebar-toggle"
                            class="text-gray-600 hover:text-orange-600 focus:outline-none lg:hidden">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                    <h2 class="text-xl font-semibold text-orange-600">My Profile</h2>
                </div>

                <div class="flex items-center space-x-3">
                    <span class="hidden sm:block text-gray-700">Welcome, <span id="header-name">Admin</span></span>
                    <div id="header-avatar"
                         class="w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-md overflow-hidden cursor-pointer">
                        <img src="" alt="" class="hidden w-full h-full profile-img">
                        <span>A</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Profile Content -->
        <main class="flex-1 overflow-y-auto p-6 container mx-auto max-w-3xl">
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8 animate-fadeIn">

                <!-- Profile Header -->
                <div class="flex flex-col sm:flex-row items-center sm:items-start space-y-4 sm:space-y-0 sm:space-x-6 mb-8">
                    <div class="relative group">
                        <div id="profile-picture"
                             class="w-28 h-28 bg-orange-500 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-lg overflow-hidden">
                            <img id="profile-img" src="" alt="" class="hidden w-full h-full profile-img">
                            <span id="initial-letter">A</span>
                        </div>
                        <label for="upload-photo"
                               class="absolute bottom-0 right-0 bg-orange-600 text-white p-2 rounded-full cursor-pointer shadow-lg hover:bg-orange-700 transition opacity-0 group-hover:opacity-100">
                            <span class="material-icons text-sm">photo_camera</span>
                            <input type="file" id="upload-photo" accept="image/*" class="hidden">
                        </label>
                    </div>

                    <div class="text-center sm:text-left flex-1">
                        <h1 id="profile-name" class="text-2xl font-bold text-gray-900">Admin User</h1>
                        <p id="profile-email" class="text-gray-600">admin@kunash.com</p>
                        <p id="profile-role" class="text-sm text-orange-600 font-medium mt-1">System Administrator</p>
                    </div>
                    <button id="edit-btn"
                            class="bg-orange-600 text-white px-5 py-2 rounded-lg hover:bg-orange-700 transition flex items-center space-x-2">
                        <span class="material-icons text-sm">edit</span>
                        <span>Edit Profile</span>
                    </button>
                </div>

                <!-- Edit Form -->
                <form id="profile-form" class="hidden space-y-5">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                        <input type="text" id="input-name"
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                               placeholder="Enter your name">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                        <input type="email" id="input-email"
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                               placeholder="Enter email">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Phone (Optional)</label>
                        <input type="tel" id="input-phone"
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                               placeholder="+91 98765 43210">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Role</label>
                        <input type="text" id="input-role"
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                               placeholder="e.g. System Administrator">
                    </div>
                    <div class="flex space-x-3 pt-4">
                        <button type="submit"
                                class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition flex items-center space-x-2">
                            <span class="material-icons text-sm">save</span>
                            <span>Save Changes</span>
                        </button>
                        <button type="button" id="cancel-btn"
                                class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition">
                            Cancel
                        </button>
                    </div>
                </form>

                <!-- View Mode -->
                <div id="profile-view">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider">Contact</h3>
                            <div class="mt-3 space-y-2">
                                <p class="flex items-center text-gray-700">
                                    <span class="material-icons text-orange-600 text-lg mr-2">email</span>
                                    <span id="view-email">admin@kunash.com</span>
                                </p>
                                <p class="flex items-center text-gray-700">
                                    <span class="material-icons text-orange-600 text-lg mr-2">phone</span>
                                    <span id="view-phone">Not set</span>
                                </p>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider">Account</h3>
                            <div class="mt-3 space-y-2">
                                <p class="flex items-center text-gray-700">
                                    <span class="material-icons text-orange-600 text-lg mr-2">badge</span>
                                    <span id="view-role">System Administrator</span>
+Z                                </p>
                                <p class="flex items-center text-gray-700">
                                    <span class="material-icons text-orange-600 text-lg mr-2">schedule</span>
                                    Joined January 2025
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<!-- Notification -->
<div id="notification"
     class="fixed bottom-4 right-4 hidden p-4 rounded-lg shadow-lg text-white text-sm"></div>

<!-- ====================== SCRIPTS ====================== -->
<script>
/* ---------- PROFILE LOGIC (same as before) ---------- */
const defaultProfile = {
    name: "Admin User",
    email: "admin@kunash.com",
    phone: "",
    role: "System Administrator",
    photo: ""
};

let profile = JSON.parse(localStorage.getItem('adminProfile')) || defaultProfile;

/* DOM Elements */
const editBtn        = document.getElementById('edit-btn');
const form           = document.getElementById('profile-form');
const view           = document.getElementById('profile-view');
const cancelBtn      = document.getElementById('cancel-btn');
const inputName      = document.getElementById('input-name');
const inputEmail     = document.getElementById('input-email');
const inputPhone     = document.getElementById('input-phone');
const inputRole      = document.getElementById('input-role');
const profileName    = document.getElementById('profile-name');
const profileEmail   = document.getElementById('profile-email');
const profileRole    = document.getElementById('profile-role');
const viewEmail      = document.getElementById('view-email');
const viewPhone      = document.getElementById('view-phone');
const viewRole       = document.getElementById('view-role');
const profileImg     = document.getElementById('profile-img');
const initialLetter  = document.getElementById('initial-letter');
const headerAvatar   = document.getElementById('header-avatar');
const headerImg      = headerAvatar.querySelector('img');
const headerLetter   = headerAvatar.querySelector('span');
const headerName     = document.getElementById('header-name');
const fileInput      = document.getElementById('upload-photo');

/* Render profile (header + body) */
const renderProfile = () => {
    // Body
    profileName.textContent   = profile.name;
    profileEmail.textContent  = profile.email;
    profileRole.textContent   = profile.role;
    viewEmail.textContent     = profile.email;
    viewPhone.textContent     = profile.phone || 'Not set';
    viewRole.textContent      = profile.role;

    inputName.value = profile.name;
    inputEmail.value = profile.email;
    inputPhone.value = profile.phone || '';
    inputRole.value = profile.role;

    // Avatar
    if (profile.photo) {
        profileImg.src = profile.photo;
        profileImg.classList.remove('hidden');
        initialLetter.classList.add('hidden');

        headerImg.src = profile.photo;
        headerImg.classList.remove('hidden');
        headerLetter.classList.add('hidden');
    } else {
        const initial = profile.name.charAt(0).toUpperCase();
        initialLetter.textContent = initial;
        headerLetter.textContent = initial;

        profileImg.classList.add('hidden');
        initialLetter.classList.remove('hidden');
        headerImg.classList.add('hidden');
        headerLetter.classList.remove('hidden');
    }

    // Header name
    if (headerName) headerName.textContent = profile.name;
};

editBtn.addEventListener('click', () => {
    form.classList.remove('hidden');
    view.classList.add('hidden');
    editBtn.classList.add('hidden');
    inputName.focus();
});

cancelBtn.addEventListener('click', () => {
    form.classList.add('hidden');
    view.classList.remove('hidden');
    editBtn.classList.remove('hidden');
    renderProfile();
});

form.addEventListener('submit', e => {
    e.preventDefault();

    const newName  = inputName.value.trim();
    const newEmail = inputEmail.value.trim();
    const newPhone = inputPhone.value.trim();
    const newRole  = inputRole.value.trim();

    if (!newName || !newEmail || !newRole) {
        showNotification('Please fill all required fields.', 'error');
        return;
    }

    profile.name  = newName;
    profile.email = newEmail;
    profile.phone = newPhone;
    profile.role  = newRole;

    localStorage.setItem('adminProfile', JSON.stringify(profile));
    window.dispatchEvent(new Event('profileUpdated'));

    renderProfile();
    form.classList.add('hidden');
    view.classList.remove('hidden');
    editBtn.classList.remove('hidden');
    showNotification('Profile updated successfully!', 'success');
});

fileInput.addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    if (file.size > 5 * 1024 * 1024) {
        showNotification('Image must be under 5MB.', 'error');
        return;
    }
    const reader = new FileReader();
    reader.onload = ev => {
        profile.photo = ev.target.result;
        localStorage.setItem('adminProfile', JSON.stringify(profile));
        window.dispatchEvent(new Event('profileUpdated'));
        renderProfile();
        showNotification('Profile picture updated!', 'success');
    };
    reader.readAsDataURL(file);
});

headerAvatar.addEventListener('click', () => {
    window.location.href = 'profile.html';
});

/* Notification helper */
const showNotification = (msg, type = 'success') => {
    const notif = document.getElementById('notification');
    notif.textContent = msg;
    notif.className = `fixed bottom-4 right-4 p-4 rounded-lg shadow-lg text-white text-sm transition-all ${type === 'success' ? 'bg-orange-600' : 'bg-red-600'}`;
    notif.classList.remove('hidden');
    setTimeout(() => notif.classList.add('hidden'), 3000);
};

/* Sync across tabs */
window.addEventListener('storage', e => {
    if (e.key === 'adminProfile') {
        profile = JSON.parse(e.newValue) || defaultProfile;
        renderProfile();
    }
});
window.addEventListener('profileUpdated', () => {
    profile = JSON.parse(localStorage.getItem('adminProfile')) || defaultProfile;
    renderProfile();
});

/* ---------- SIDEBAR LOGIC (identical to index.html) ---------- */
const sidebar        = document.getElementById('sidebar');
const mainContent    = document.querySelector('.main-content');
const toggleBtn      = document.getElementById('toggle-btn');
const toggleIcon     = toggleBtn.querySelector('.material-icons');
const sidebarToggle  = document.getElementById('sidebar-toggle');
let isCollapsed = false;

toggleBtn.addEventListener('click', () => {
    isCollapsed = !isCollapsed;
    if (isCollapsed) {
        sidebar.classList.add('sidebar-collapsed');
        mainContent.classList.remove('ml-64');
        mainContent.classList.add('ml-20');
        toggleIcon.textContent = 'chevron_right';
    } else {
        sidebar.classList.remove('sidebar-collapsed');
        mainContent.classList.remove('ml-20');
        mainContent.classList.add('ml-64');
        toggleIcon.textContent = 'chevron_left';
    }
});

if (sidebarToggle) {
    sidebarToggle.addEventListener('click', () => {
        sidebar.classList.toggle('-translate-x-full');
    });
}

/* Close mobile sidebar when clicking outside */
document.addEventListener('click', e => {
    if (window.innerWidth < 1024) {
        const inside = sidebar.contains(e.target) || (sidebarToggle && sidebarToggle.contains(e.target));
        if (!inside && !sidebar.classList.contains('-translate-x-full')) {
            sidebar.classList.add('-translate-x-full');
        }
    }
});

window.addEventListener('resize', () => {
    if (window.innerWidth >= 1024) {
        sidebar.classList.remove('-translate-x-full');
        if (!isCollapsed) mainContent.classList.add('ml-64');
    } else {
        mainContent.classList.remove('ml-64', 'ml-20');
    }
});

/* Logout */
document.getElementById('logout-btn')?.addEventListener('click', e => {
    e.preventDefault();
    if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('adminAuth');
        sessionStorage.clear();
        window.location.href = '../login.html';
    }
});

/* Initial render */
renderProfile();
</script>
</body>
</html>